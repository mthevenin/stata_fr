<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>couleurs</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Stata</a>
</li>
<li>
  <a href="utils.html">Tips &amp; utilitaires</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Graphiques
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="graphiques.html">Graphiques</a>
    </li>
    <li>
      <a href="couleurs.html">Couleurs</a>
    </li>
    <li>
      <a href="programmes.html">Programmes</a>
    </li>
  </ul>
</li>
<li>
  <a href="python.html">Python</a>
</li>
<li>
  <a href="commandes.html">Commandes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">couleurs</h1>

</div>


<p><strong>version 0</strong><br />
<strong>[X]: A faire</strong></p>
<p>[Maj à prévoir]</p>
<div id="colorpalette" class="section level1">
<h1><span class="header-section-number">1</span> Colorpalette</h1>
<div id="sources-et-installation" class="section level2">
<h2><span class="header-section-number">1.1</span> Sources et installation</h2>
<p>Sources: <a href="http://repec.sowi.unibe.ch/stata/palettes/index.html" class="uri">http://repec.sowi.unibe.ch/stata/palettes/index.html</a> <a href="https://www.stata-journal.com/article.html?article=gr0075" class="uri">https://www.stata-journal.com/article.html?article=gr0075</a> <a href="https://boris.unibe.ch/116571/1/Jann-2018-palettes.pdf" class="uri">https://boris.unibe.ch/116571/1/Jann-2018-palettes.pdf</a></p>
<p><strong>Installation via ssc</strong></p>
<ul>
<li><code>ssc install palettes, replace</code></li>
<li><code>ssc install colrspace, replace</code></li>
</ul>
<p><strong>Installation de grstyle pour charger et utiliser une palette</strong> * <code>ssc install grstyle, replace</code></p>
<p><strong>Autres sources</strong></p>
<ul>
<li>Librairie particulièrement complète de palettes de couleurs: <a href="https://www.w3schools.com/colors/default.asp" class="uri">https://www.w3schools.com/colors/default.asp</a></li>
<li>Colorbrewers: <a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3" class="uri">https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</a></li>
</ul>
</div>
<div id="syntaxe-et-exemples" class="section level2">
<h2><span class="header-section-number">1.2</span> Syntaxe et exemples</h2>
<p>Visualiser une palette</p>
<pre><code>colorpalette nom_palette [, options] </code></pre>
<p>La palette par défaut de Stata est la palette s2 (15 couleurs) utilisée par le thème par défaut <strong>s2color</strong>:</p>
<pre><code>colorpalette s2</code></pre>
<p><img src="imgc/g1.png" style="width:75.0%" /> <br></p>
<ul>
<li>Lorsqu’on fait un graphique, les couleurs utilisées pour chaque objet (courbes par exemples) suivent l’ordre d’affichage de la palette: (1) “navy”, (2) “maroon”, (3) “forest green”…….</li>
<li>On peut forcer la commande à afficher le code <strong>RGB</strong>:</li>
</ul>
<pre><code>colorpalette s2, force</code></pre>
<p><img src="imgc/g2.png" style="width:75.0%" /></p>
<p><br></p>
<ul>
<li>On peut sélectionner une partie de la palette (très utile au final - voir plus loin)</li>
</ul>
<pre><code>colorpalette nom_palette, select(numlist)</code></pre>
<p>Exemple</p>
<pre><code>colorpalette s2, select(1 6 14)</code></pre>
<p><img src="imgc/g3.png" style="width:75.0%" /> &gt; <br></p>
<ul>
<li>On peut réduire la taille de la palette [très utile]</li>
</ul>
<pre><code>colorpalette nom_palette, n(#)</code></pre>
<ul>
<li>On veut donner un aspect plus “pastel” à la palette: option <code>intensity</code>
<ul>
<li>La commande <code>colorpalette</code> permet également d’utiliser toutes les options graphiques <code>tw</code>. En modifiant les couleurs, le code couleur a plus d’arguments et empiète sur le numéro de la couleur juste à sa droite. J’utilise l’option `scale(#)’ pour réduire la taille de tous les éléments présent dans le graphique (colorpalette génère des graphs), ici avec une échelle d’affichage de 90%.</li>
<li>L’option <code>intensity(#)</code> permet de baisser (vers le pastel) ou d’augmenter l’intensité des couleurs</li>
</ul></li>
</ul>
<pre><code>colorpalette s2, intensity(0.50) force  gropts(scale(0.9))</code></pre>
<div class="figure">
<img src="imgc/g4.png" alt="Intensité à 0.5" style="width:75.0%" />
<p class="caption">Intensité à 0.5</p>
</div>
<p><br></p>
<ul>
<li>On peut visualiser l’effet au niveau des couleurs du changement d’opacité (transparence) avec l’option <code>opacity(#)</code> [# de 0+ à 100-]</li>
</ul>
<pre><code>colorpalette s2, opacity(50) force  gropts(scale(0.9))</code></pre>
<div class="figure">
<img src="imgc/g5.png" alt="50% de transparence" style="width:75.0%" />
<p class="caption">50% de transparence</p>
</div>
<p><br></p>
<ul>
<li>Toutes les options disponibles (derniere version dans dépôt Stata)</li>
</ul>
<pre><code>    Main
      n(#)                size of the palette (number of colors)
      select(numlist)     select (and order) the colors
      order(numlist)      order the colors
      reverse             arrange palette in reverse order
      opacity(numlist)    set opacity, in percent
      intensity(numlist)  set color intensity multipliers
      ipolate(spec)       interpolate the colors
      intensify(numlist)  modify intensity
      saturate(spec)      modify saturation (colorfulness)
      luminate(spec)      modify luminance (brightness)
      gscale[(spec)]      convert to grayscale
      cblind[(spec)]      simulate color vision deficiency
      other               palette-specific options

    Technical
      forcergb            enforce translation to RGB
      noexpand            omit automatic interpolation/recycling
      class(class)        set palette class</code></pre>
</div>
<div id="utilisation-des-macros-générées-par-colorpalette" class="section level2">
<h2><span class="header-section-number">1.3</span> Utilisation des macros générées par colorpalette</h2>
<ul>
<li>Colorpalette enregistre les noms ou codes des couleurs sous forme de macro (<code>return list</code>)</li>
<li>Ces valeurs peuvent donc être utilisée automatiser la sélection des couleurs</li>
</ul>
<pre><code>colorpalette s2,  nograph
return list

. return list

scalars:
                  r(n) =  15

macros:
              r(ptype) : &quot;color&quot;
              r(pname) : &quot;s2&quot;
             r(pclass) : &quot;qualitative&quot;
                  r(p) : &quot;&quot;26 71 111&quot; &quot;144 53 59&quot; &quot;85 117 47&quot; &quot;227 126 0&quot; &quot;110 142 132&quot; &quot;193 5 52&quot; &quot;147 141 210&quot; ..&quot;
            r(p15info) : &quot;bluishgray&quot;
                r(p15) : &quot;217 230 235&quot;
            r(p14info) : &quot;gold&quot;
                r(p14) : &quot;255 210 0&quot;
            r(p13info) : &quot;erose&quot;
                r(p13) : &quot;191 161 156&quot;
            r(p12info) : &quot;brown&quot;
                r(p12) : &quot;156 136 71&quot;
            r(p11info) : &quot;emerald&quot;
                r(p11) : &quot;45 109 102&quot;
            r(p10info) : &quot;emidblue&quot;
                r(p10) : &quot;123 146 168&quot;
             r(p9info) : &quot;sienna&quot;
                 r(p9) : &quot;160 82 45&quot;
             r(p8info) : &quot;khaki&quot;
                 r(p8) : &quot;202 194 126&quot;
             r(p7info) : &quot;lavender&quot;
                 r(p7) : &quot;147 141 210&quot;
             r(p6info) : &quot;cranberry&quot;
                 r(p6) : &quot;193 5 52&quot;
             r(p5info) : &quot;teal&quot;
                 r(p5) : &quot;110 142 132&quot;
             r(p4info) : &quot;dkorange&quot;
                 r(p4) : &quot;227 126 0&quot;
             r(p3info) : &quot;forest_green&quot;
                 r(p3) : &quot;85 117 47&quot;
             r(p2info) : &quot;maroon&quot;
                 r(p2) : &quot;144 53 59&quot;
             r(p1info) : &quot;navy&quot;
                 r(p1) : &quot;26 71 111&quot;</code></pre>
<ul>
<li>la macro <strong>r(p)</strong> contient donc tous les codes couleurs de la palette <em>s2</em></li>
</ul>
<pre><code>di r(p)
&quot;26 71 111&quot; &quot;144 53 59&quot; &quot;85 117 47&quot; &quot;227 126 0&quot; &quot;110 142 132&quot; &quot;193 5 52&quot; &quot;147 141 210&quot; &quot;202 194 126&quot; &quot;160 82 45&quot; &quot;123 146 168&quot; &quot;45 109 102&quot; &quot;156 136 71&quot; &quot;191 161 156&quot; &quot;255 210 0&quot; &quot;217 230 235&quot;</code></pre>
<ul>
<li>On pourra donc utiliser cette macro pour indiquer les couleurs qui seront utilisées dans le graphique</li>
</ul>
<p><strong>Exemple</strong></p>
<pre><code>sysuse uslifeexp.dta
tw line le le_male le_female year</code></pre>
<p><img src="imgc/g6.png" style="width:75.0%" /></p>
<p><br></p>
<p>Les couleurs des trois courbes sont bien les trois premières couleurs de la palette <code>s2</code>.<br />
<br> Si on souhaite utiliser les couleurs (5,6,14) au lieu des couleurs (1,2,3) de la palette complète + une intensité de 1.2:</p>
<pre><code>colorpalette s2, select(5 6 14) intensity(1.2) nograph
tw line le le_male le_female year, lc(`r(p)&#39;)</code></pre>
<p>Rappel: <code>lc()</code> est l’expression tronquée de <code>lcolor()</code> [line color]</p>
<p><img src="imgc/g7.png" style="width:75.0%" /></p>
<p><br></p>
</div>
<div id="utilisation-dune-palette-de-couleurs-avec-grstyle" class="section level2">
<h2><span class="header-section-number">1.4</span> Utilisation d’une palette de couleurs avec grstyle</h2>
<ul>
<li>Les options et la récupération des couleurs sélectionnées sont également intégrées à la commande <code>grstyle</code> de Ben Jann [<code>grstyle set color [options]</code>]</li>
<li>En sélectionnant cette fois-ci les couleurs (1,6,4) de la palette <em>s2</em> et en customizant légèrement le graphique:</li>
</ul>
<pre><code>grstyle init
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal
grstyle set color s2, select(1 6 4)

tw line le le_male le_female year, legend(cols(3))</code></pre>
<p><img src="imgc/g8.png" style="width:75.0%" /></p>
<p><br></p>
</div>
<div id="cas-dun-graphique-à-plusieurs-composantes" class="section level2">
<h2><span class="header-section-number">1.5</span> Cas d’un graphique à plusieurs composantes</h2>
<p><strong>Avec colorpalette</strong></p>
<ul>
<li>Pour un graphique à plusieurs composantes [<code>tw (objet1) (objet2)...</code>] ou [<code>tw objet1 || (objet2 ||...</code>] , on ne peut pas utiliser d’un bloc tous les codes couleurs avec <code>r(p)</code></li>
<li>On doir inséré la macro de chaque composantes dans ses options <code>r(p1)</code>, <code>r(p2)</code>…. La modification des couleurs est néanmoins automatisée avec <code>colorpalette</code></li>
</ul>
<p>Exemple</p>
<pre><code>colorpalette s2, select(6 14) opacity(50) nograph

local opts mlc(black) mlw(vthin)

tw (scatter price mpg if foreign==0, mc(`r(p1)&#39;) `opts&#39;)  ///
   (scatter price mpg if foreign==1, mc(`r(p2)&#39;) `opts&#39;), ///
   legend(order(1 &quot;Domestic&quot; 2 &quot;Foreign&quot;))</code></pre>
<p><img src="imgc/g9.png" style="width:75.0%" /></p>
<p><br></p>
<p><strong>Avec grstyle</strong></p>
<ul>
<li>Avec <code>grstyle</code> la procédure est simplifiée au niveau du graphique, l’option pour la couleur de remplissage des marqueurs est chargée avec <code>grstyle set color s2, select(6 14) opacity(50)</code></li>
</ul>
<pre><code>grstyle init
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal
grstyle set color s2, select(6 14) opacity(50)

local opts mlc(black) mlw(vthin)

tw (scatter price mpg if foreign==0, `opts&#39;)  ///
   (scatter price mpg if foreign==1, `opts&#39;), ///
    legend(order(1 &quot;Domestic&quot; 2 &quot;Foreign&quot;))</code></pre>
<p><strong>Remarque</strong>: <code>grstyle</code> permet également de paramétrer la couleur et l’épaisseur des contours des marqueurs</p>
</div>
<div id="la-palette-de-couleur-de-ggplot2" class="section level2">
<h2><span class="header-section-number">1.6</span> La palette de couleur de ggplot2</h2>
<ul>
<li>Avec <code>colorpalette</code>, le nom de la palette utilisée par le standard <strong>ggplot2</strong> est <strong>hue</strong> (15 couleurs par défaut)</li>
</ul>
<pre><code>colorpalette hue</code></pre>
<p><img src="imgc/g10.png" /></p>
<p><br></p>
<ul>
<li>La sélection automatique des couleurs sur une palette à 15 éléments ne donne pas un résultat pertinent niveau visualisation</li>
</ul>
<pre><code>sysuse uslifeexp.dta
*set scheme s2color
colorpalette hue, nograph
tw line le le_male le_female year, lc(`r(p)&#39;)</code></pre>
<p><img src="imgc/g11.png" style="width:75.0%" /></p>
<p><br></p>
<ul>
<li>Il convient donc:
<ul>
<li>de sélectionner des couleurs adaptées pour éviter les effets de dégradé qui ne sont pas les bienvenus dans certains graphiques. On peut donc:
<ul>
<li>utiliser l’option <code>select(#)</code> pour générer une palette pertinente au niveau des couleurs et de l’ordre d’utilisation</li>
<li>Utiliser l’option <code>n(#)</code> [# taille de la palette]:</li>
</ul></li>
</ul></li>
</ul>
<div style="border: 1px solid black">
<div class="figure">
<img src="imgc/g13.png" alt="En abcisse l’ordre des couleurs, en ordonnée la taille de la palette" />
<p class="caption">En abcisse l’ordre des couleurs, en ordonnée la taille de la palette</p>
</div>
</div>
<p><br></p>
<ul>
<li>Comme le graphique précédent est composé de trois courbes, on utilise l’option <code>n(3)</code> à <code>colorpalette</code> :</li>
</ul>
<pre><code>sysuse uslifeexp.dta
*set scheme s2color
colorpalette hue, n(3) nograph
tw line le le_male le_female year, lc(`r(p)&#39;)</code></pre>
<p><img src="imgc/g12.png" style="width:75.0%" /></p>
<p><br></p>
<p>Avec `grstyle``</p>
<pre><code>grstyle init
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal
grstyle set color hue, n(3)
tw line le le_male le_female year, legend(cols(3))</code></pre>
<p><img src="imgc/g14.png" style="width:75.0%" /> <br></p>
<p><strong>Rappels sur les courbes</strong>: attention au nombre de courbes affichées dans un même graphique, cela peut devenir illisible (<em>effet spaghetti</em>)</p>
</div>
</div>
<div id="exemples-de-palette" class="section level1">
<h1><span class="header-section-number">2</span> Exemples de palette</h1>
<p><strong>[A voir: mettre quelques exemples de graphiques]</strong></p>
<ul>
<li>Se reporter à l’aide de <code>colorpalette</code>, il est possible de visualiser directement un nombre impressionnant de palettes de couleurs</li>
<li>Trois type de palettes:
<ul>
<li>Les palettes <em>qualitatives</em>: on mixe plusieurs types de couleurs (bleu, rouge, jaune, vert…)</li>
<li>Les palettes <em>divergentes</em>: on va d’une couleurs à une autre (du bleu au rouge) en altérant l’intensité avec une couleur de transition généralement proche du blanc. Ces palettes peuvent être rendues qualitative en réduisant la taille de la palette</li>
<li>Les palettes <em>séquentielles</em>: on baisse (ou augmente) l’intensité d’une seule couleur (bleu vif vers le blanc ou l’inverse)</li>
</ul></li>
</ul>
<div id="palette-stata" class="section level2">
<h2><span class="header-section-number">2.1</span> Palette Stata</h2>
<p>Palettes de types qualitatives</p>
<p><img src="imgc/g15.png" style="width:75.0%" /></p>
</div>
<div id="palettes-thèmes-externe-stata" class="section level2">
<h2><span class="header-section-number">2.2</span> Palettes thèmes externe Stata</h2>
<p>Palettes de types qualitatives</p>
<p><img src="imgc/g16.png" style="width:75.0%" /></p>
</div>
<div id="hcl" class="section level2">
<h2><span class="header-section-number">2.3</span> HCL</h2>
<pre><code>`coloraplette hcl, nom_sous_palette [options]`</code></pre>
<div id="qualitatives" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Qualitatives</h3>
<p><img src="imgc/g17.png" style="width:75.0%" /></p>
<p><br></p>
<ul>
<li>La palettes <strong>hcl intense</strong> est identique à la palette <strong>hue</strong> de la section précédente, ici avec 9 couleurs <code>n(9)</code></li>
<li>Si on veut afficher et utiliser la palette <strong>hcl qualitative</strong> avec les valeurs RGB:</li>
</ul>
<pre><code>coloraplette hcl, qualitative force</code></pre>
<p><img src="imgc/g18.png" style="width:75.0%" /></p>
</div>
<div id="séquentielles" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Séquentielles</h3>
<p><img src="imgc/g20.png" style="width:75.0%" /></p>
<p><br></p>
<p>La palette <strong>VIRIDIS</strong> est très populaire en dataviz, et peut-être utilisée comme une palette qualitative avec un nombre limité de couleurs</p>
<div class="figure">
<img src="imgc/g21.png" alt="Palette Viridis à 4 couleurs" style="width:75.0%" />
<p class="caption">Palette Viridis à 4 couleurs</p>
</div>
</div>
<div id="divergentes" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Divergentes</h3>
<p><img src="imgc/g22.png" style="width:75.0%" /></p>
</div>
</div>
<div id="hsv" class="section level2">
<h2><span class="header-section-number">2.4</span> HSV</h2>
<p>Proche de la précédentes avec, me semble t-il, des intensités plus élevées</p>
<pre><code>coloraplette hsv, nom_sous_palette [options]</code></pre>
<div id="qualitatives-1" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Qualitatives</h3>
<p><img src="imgc/g23.png" /></p>
</div>
<div id="séquentielles-1" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Séquentielles</h3>
<p><img src="imgc/g24.png" style="width:75.0%" /></p>
</div>
<div id="divergentes-1" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Divergentes</h3>
<p><img src="imgc/g25.png" style="width:75.0%" /></p>
</div>
</div>
<div id="colorbrewer" class="section level2">
<h2><span class="header-section-number">2.5</span> Colorbrewer</h2>
<p><a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3" class="uri">https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</a></p>
<pre><code>`coloraplette nom_palette [,options]`</code></pre>
<div id="qualitatives-2" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Qualitatives</h3>
<p><img src="imgc/g26.png" style="width:75.0%" /></p>
</div>
<div id="séquentielles-2" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Séquentielles</h3>
<p><img src="imgc/g27.png" style="width:75.0%" /></p>
<p><br></p>
<p><img src="imgc/g28.png" style="width:75.0%" /></p>
</div>
<div id="divergentes-2" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Divergentes</h3>
<p><img src="imgc/g29.png" style="width:75.0%" /></p>
</div>
</div>
<div id="viridis" class="section level2">
<h2><span class="header-section-number">2.6</span> Viridis</h2>
<ul>
<li>Voir plus haut les palettes <strong>hcl</strong></li>
<li>Les palettes <strong>viridis</strong> sont régulièrement utilisées avec Python</li>
<li>Elles sont plutôt de type séquentielles ou divergentes</li>
<li>On peut les rendre qualitative en réduisant la taille de la palette <code>n(#)</code></li>
</ul>
<pre><code>coloraplette nom_palette [,options]</code></pre>
<p><img src="imgc/g30.png" style="width:75.0%" /></p>
<p><br></p>
<div class="figure">
<img src="imgc/g31.png" alt="Palettes à 4 couleurs" style="width:75.0%" />
<p class="caption">Palettes à 4 couleurs</p>
</div>
</div>
<div id="matplotlib" class="section level2">
<h2><span class="header-section-number">2.7</span> Matplotlib</h2>
<p>Palettes des objets graphiques de la librairie <code>matplotlib</code> de Python</p>
<pre><code>coloraplette matplotlib, nom_sous_palette [options]</code></pre>
<p><img src="imgc/g32.png" style="width:75.0%" /></p>
<p><br></p>
<div class="figure">
<img src="imgc/g33.png" alt="Palettes à 4 couleurs" style="width:75.0%" />
<p class="caption">Palettes à 4 couleurs</p>
</div>
</div>
<div id="ptol" class="section level2">
<h2><span class="header-section-number">2.8</span> Ptol</h2>
<p>3 types de palette: qualitative, divergente et de type arc en ciel</p>
<pre><code>coloraplette ptol, nom_sous_palette [options]</code></pre>
<p><img src="imgc/g35.png" style="width:75.0%" /></p>
<p>La première palette (3 couleurs): <code>colorpalette ptol, qualitative n(3)</code></p>
</div>
<div id="d3" class="section level2">
<h2><span class="header-section-number">2.9</span> D3</h2>
<pre><code>coloraplette d3, nom_sous_palette [options]</code></pre>
<ul>
<li>La première palette à 10 couleurs est qualitative</li>
<li>La seconde palette à 20 couleurs est composée de 10 paires qualitatives, avec un élément plus foncé et un élément claire</li>
<li>Les troisièmes et quatrième palettes ont 20 couleurs à 5 ensembles qualitatifs (bleu,orange vert, mauve, gris) avec des éléments allant du du plus foncé au plus claire</li>
</ul>
<p><img src="imgc/g36.png" style="width:75.0%" /></p>
<p><br></p>
</div>
<div id="spmap" class="section level2">
<h2><span class="header-section-number">2.10</span> Spmap</h2>
<p>Comme son nom l’indique, il s’agit d’un ensemble de palettes prévues pour générer des cartes.<br />
Ces palettes (et d’autres) sont intégrées dans la commande Stata du même nom (<code>ssc install spmap</code>[M.Pisatti] - <code>help spmap</code>)</p>
<pre><code>coloraplette spmap, nom_sous_palette [options]</code></pre>
<p><img src="imgc/g38.png" style="width:75.0%" /></p>
<p><br></p>
<p>Exemples (palettes <em>reds</em> et <em>rainbow</em>)</p>
<pre><code>* help spmap
use &quot;Italy-RegionsData.dta&quot;, clear
spmap relig1 using &quot;Italy-RegionsCoordinates.dta&quot;, id(id)            ///
clnumber(20) fcolor(Reds2) ocolor(none ..)                           ///
title(&quot;Pct. Catholics without reservations&quot;, size(*0.8))             ///
subtitle(&quot;Italy, 1994-98&quot; &quot; &quot;, size(*0.8))                           ///
legstyle(3) legend(ring(1) position(3))  name(g1, replace) nodraw

spmap relig1 using &quot;Italy-RegionsCoordinates.dta&quot;, id(id)           ///
clnumber(20) fcolor(Rainbow) ocolor(none ..)                        ///
title(&quot;Pct. Catholics without reservations&quot;, size(*0.8))            ///
subtitle(&quot;Italy, 1994-98&quot; &quot; &quot;, size(*0.8))                          ///
legstyle(3) legend(ring(1) position(3))  name(g2, replace) nodraw

graph combine g1 g2, ysize(9) xsize(20)  plotr(color(white))  graphr(color(white))</code></pre>
<p><img src="imgc/g39.png" style="width:75.0%" /></p>
<p><strong>Remarques</strong>:</p>
<ul>
<li>La commande <code>spmap</code> ne fonctionne pas avec <code>grstyle set color</code></li>
<li>Elle intègre au total 45 palettes</li>
</ul>
<p><br><br> Autres palettes contenues dans <code>colorpalette</code>: <strong>lin</strong>, <strong>webcolors</strong>, <strong>sfso</strong></p>
</div>
</div>
<div id="exemples-de-graphiques" class="section level1">
<h1><span class="header-section-number">3</span> Exemples de graphiques</h1>
<div id="palettes-qualitatives" class="section level2">
<h2><span class="header-section-number">3.1</span> Palettes qualitatives</h2>
<p><strong>Pyramide des âges et évolution de l’espérance de vie</strong><br />
<br> Le programme pour la pyramide des âges est donné dans l’aide de <code>help tw bar</code></p>
<p>Programme</p>
<ul>
<li>Le seul élément modifié est <code>grstyle set color NOM_PALETTE [OPTIONS]</code></li>
<li>La pyramide est définie et exécutée par la fonction <code>pyramide</code></li>
</ul>
<div id="s2" class="section level3">
<h3><span class="header-section-number">3.1.1</span> S2</h3>
<p><img src="imgc/e1.png" style="width:75.0%" /></p>
</div>
<div id="hue" class="section level3">
<h3><span class="header-section-number">3.1.2</span> HUE</h3>
<p><img src="imgc/e2.png" style="width:75.0%" /></p>
</div>
<div id="colorbrewer---dark2" class="section level3">
<h3><span class="header-section-number">3.1.3</span> COLORBREWER - DARK2</h3>
<ul>
<li>Pallete de <code>colorbrewer</code></li>
<li>L’intensité pour les courbes a été augmenté de 20%</li>
</ul>
<p><img src="imgc/e3.png" /></p>
</div>
<div id="viridis-1" class="section level3">
<h3><span class="header-section-number">3.1.4</span> VIRIDIS</h3>
<p><img src="imgc/e4.png" style="width:75.0%" /></p>
</div>
</div>
<div id="palettes-séquentielles-et-divergentes" class="section level2">
<h2><span class="header-section-number">3.2</span> Palettes séquentielles et divergentes</h2>
<div id="barres" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Barres</h3>
<p><strong>Répartition d’une variable ordinale</strong></p>
<pre><code>use nhanes2f, clear

tab health race, nof col

/*
1=poor,... |
         , |
5=excellen |    1=white, 2=black, 3=other
         t |     White      Black      Other |     Total
-----------+---------------------------------+----------
      poor |      6.37      13.26       4.50 |      7.05 
      fair |     15.50      22.28      12.50 |     16.16 
   average |     27.65      32.97      39.00 |     28.43 
      good |     25.96      18.05      23.00 |     25.07 
 excellent |     24.52      13.44      21.00 |     23.29 
-----------+---------------------------------+----------
     Total |    100.00     100.00     100.00 |    100.00 
*/

grstyle init
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal
grstyle set color NOM_PALETTE [, OPTIONS]  

catplot health race, ///
percent(race) asyvars legend(pos(3) cols(1)) nodraw name(g1, replace)
catplot health race, ///
percent(race) asyvars stack legend(pos(3) cols(1)) nodraw name(g2,replace)

grc1leg g1 g2, ysize(9) xsize(20) legendfrom(g1) pos(3)  plotr(color(white))  graphr(color(white))</code></pre>
<div id="hcl---blues" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> HCL - BLUES</h4>
<ul>
<li>La taille de la palette a été fixée à 6 couleurs (la variable <em>health</em> a 5 modalité) pour éviter un bleu trop proche du blanc</li>
<li>Si une modalité est très proche du blanc, il convient de modifié la couleur du background (avec <code>grstyle</code>: <code>grstyle set imesh,  horizontal</code> )</li>
</ul>
<p><img src="imgc/e5.png" /></p>
</div>
<div id="viridis-2" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> VIRIDIS</h4>
<p><img src="imgc/e6.png" /></p>
</div>
<div id="matplotlib--" class="section level4">
<h4><span class="header-section-number">3.2.1.3</span> MATPLOTLIB -</h4>
<p><strong>Les 4 saisons de matplotlib</strong></p>
<p><img src="imgc/e7.png" /></p>
</div>
</div>
<div id="bulles---matplotlib" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Bulles - Matplotlib</h3>
<ul>
<li>Données issues du site <a href="https://www.gapminder.org/data/" class="uri">https://www.gapminder.org/data/</a></li>
<li>Utilisation des palettes matplotlib “4 saisons”:
<ul>
<li><strong>Winter</strong>: Afrique</li>
<li><strong>Spring</strong>: Asie (+ Océanie)</li>
<li><strong>Summer</strong>: Amériques</li>
<li><strong>Autumn</strong>: Europe</li>
</ul></li>
<li>[<strong>gapminder project</strong>] graphique animé: <a href="https://www.gapminder.org/tools/#$chart-type=bubbles" class="uri">https://www.gapminder.org/tools/#$chart-type=bubbles</a></li>
<li><p>[<strong>Demetris Christodoulou</strong>] graphique généré par Stata [avec bien plus d’options]: <a href="https://graphworkflow.com/2019/09/23/tribute-to-hans-rosling/" class="uri">https://graphworkflow.com/2019/09/23/tribute-to-hans-rosling/</a></p></li>
<li><p><strong>Avec une opacité de 80%</strong>. Comme le graphique est combiné, on ne distingue pas très bien les bulles superposées</p></li>
</ul>
<p><img src="imgc/gm1.png" /></p>
</div>
<div id="densité---matplotlib" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Densité - Matplotlib</h3>
<ul>
<li>Même données et mêmes palettes que pour les bulles</li>
<li>Les densités ont été estimées [commande <code>kdensity</code>] avec comme niveau d’observation les pays:
<ul>
<li>Asie (+Océanie): N=29</li>
<li>Africa: N=49</li>
<li>Americas: N=24</li>
<li>Europe: N=30</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><strong>Avec 80% d’opacité</strong></li>
</ul>
<p><img src="imgc/gm2.png" /></p>
<p><br></p>
<ul>
<li><strong>Avec 50% d’opacité</strong> <img src="imgc/gm2b.png" /></li>
</ul>
<p><br></p>
<ul>
<li><strong>Avec 80% d’opacité sans contour</strong></li>
</ul>
<p><img src="imgc/gm3.png" /></p>
<p><br></p>
<ul>
<li><strong>Avec 80% d’opacité et contour</strong> <img src="imgc/gm3b.png" /></li>
</ul>
<p><br></p>
<ul>
<li><strong>Avec 50% d’opacité et contour</strong> <img src="imgc/gm3c.png" /></li>
</ul>
<p><br> <strong>Elements de programme pour le graphique à bulle [année 1957]</strong></p>
<pre><code>use gm2, clear
* Asie et Océanie fusionnée
gen af_lf=lifeexp if continent==&quot;Africa&quot;
gen am_lf=lifeexp if continent==&quot;Americas&quot;
gen as_lf=lifeexp if continent==&quot;Asia&quot; | continent==&quot;Oceania&quot;
gen eu_lf=lifeexp if continent==&quot;Europe&quot;
gen lg = log(gdppercap)


*1957

* Les couleurs n&#39;ont pas été introduites automatiquement car issues de palettes différentes
* L&#39;utilisation d&#39;une palette qualitative le permettrait

grstyle init //s0, replace
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal

local leg  &quot;order(1 &quot;Asia&quot; 2 &quot;Americas&quot; 3 &quot;Africa&quot; 4 &quot;Europe&quot;)&quot;
local mlc  &quot;mlc(black black black black)&quot;
local mlw  &quot;mlw(vthin vthin vthin vthin)&quot;
local mc   &quot;mc(&quot;255 109 146%90&quot; &quot;91 173 102%90&quot; &quot;0 109 200%90&quot; &quot;255 109 0%90&quot;)&quot;


tw scatter as_lf am_lf af_lf eu_lf lg [w=pop] if year==1957, ///
`mlc&#39; `mlw&#39; `mc&#39; ///
ylabel(20(10)90) xlabel(5(1)12) ytitle(&quot;Espérance de vie&quot;) ///
xtitle(&quot;&quot;)  ///
legend(pos(3) col(1)`leg&#39;) name(g31, replace)  ysize(10) xsize(20)</code></pre>
<p><br> <strong>Elements de programme pour le graphique avec les densités [4 continents en 1957 et 2007]</strong></p>
<pre><code>
* Exemple: calcul des densités pour l&#39;Asie
local l 1957 1967 1977 1987 1997 2007
foreach i of local l {
kdensity lifeexp if continent==&quot;Asia&quot; &amp; year==`i&#39;, gen(as_x`i&#39; as_d`i&#39;) nograph bwidth(3)
}
*[Non reporté: Calcul des densités pour les autres continents]


* Les couleurs n&#39;ont pas été introduites automatiquement car issues de palettes différentes

grstyle init
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal

local leg &quot;order(1 &quot;Europe&quot; 2 &quot;Americas&quot; 3 &quot;Africa&quot; 4 &quot;Asia&quot;)&quot;
local lc &quot;lc(black) lw(vthin)&quot;
local fcas fcolor(&quot;255 0 255%80&quot;)
local fcam fcolor(&quot;0 128 102%80&quot;)
local fcaf fcolor(&quot;0 0 255%80&quot;)
local fceu fcolor(&quot;255 0 0%80&quot;)


tw (area eu_d1957 eu_x1957, `lc&#39; `fceu&#39;)         ///
   (area am_d1957 am_x1957, `lc&#39; `fcam&#39;)         ///
   (area af_d1957 af_x1957, `lc&#39; `fcaf&#39;)         ///
   (area as_d1957 as_x1957,`lc&#39;  `fcas&#39;) ,       ///
legend(pos(2) col(1) `leg&#39;)                      ///
ylab(0(0.05)0.1) xlab(20(10)90)                  ///
xtitle(&quot;&quot;) ytitle(&quot;Density&quot;)
</code></pre>
<p><br> <strong>Elements de programme pour le graphique avec les densités [Asie de 1957 à 2007 avec 80% d’opcité et contour]</strong></p>
<pre><code>
local l 1957 1967 1977 1987 1997 2007
foreach i of local l {
kdensity lifeexp if continent==&quot;Asia&quot; &amp; year==`i&#39;, gen(as_x`i&#39; as_d`i&#39;) nograph bwidth(3)
}

local l1 lc(black) lw(vthin)

local l 1957 1967 1977 1987 1997 2007
foreach i of local l {
local x `x&#39;  area as_d`i&#39; as_x`i&#39;, `l1&#39; ||
}

local i = 1
levelsof year, local(l)
foreach val of local l {
local leg `&quot;`leg&#39; label(`i&#39; `&quot;&quot;`val&#39;&quot;&quot;&#39;)&quot;&#39;
local ++i
}

grstyle init s1, replace
grstyle set legend, nobox stack
grstyle set plain, horizontal grid compact
grstyle set mesh,  horizontal
grstyle set color matplotlib, spring opacity(80) n(6) reverse


tw `x&#39;, ///
legend(`leg&#39; pos(2) col(1)) title(&quot;ASIA&quot;) ///
xtitle(&quot;&quot;) ytitle(&quot;density&quot;)             ///
ylab(0(0.05)0.1) xlab(20(10)90) </code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
