<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lollipop</title>

<script src="site_libs/header-attrs-2.2/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Stata</a>
</li>
<li>
  <a href="utils.html">Astuces &amp; utilitaires</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Graphiques
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="graphiques.html">Formation 2020</a>
    </li>
    <li>
      <a href="ridge.html">Ridge</a>
    </li>
    <li>
      <a href="lollipop.html">Lollipop</a>
    </li>
    <li>
      <a href="spaghetti.html">Effet spaghetti</a>
    </li>
  </ul>
</li>
<li>
  <a href="python.html">Python</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lollipop</h1>

</div>


<p><a href="https://mthevenin.github.io/stata_fr/graphiques.html#55_Barres,_lollipop_et_parallel_lines" class="uri">https://mthevenin.github.io/stata_fr/graphiques.html#55_Barres,_lollipop_et_parallel_lines</a></p>
<p><em>Données</em></p>
<pre><code>webuse set  &quot;https://raw.githubusercontent.com//mthevenin/stata_fr/master/&quot;
webuse &quot;baselol.dta&quot;, clear
webuse set</code></pre>
<p><strong>Barres</strong></p>
<p><img src="imgp/g6.png" style="width:75.0%" /></p>
<pre><code>graph hbar  x, over(y, sort(x) descending)</code></pre>
<div id="générer-un-lollipop" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Générer un lollipop</h1>
<p><em>Graphique de base</em></p>
<p><img src="imgp/g7.png" style="width:75.0%" /></p>
<p>2 étapes:</p>
<ul>
<li>Créer une base collapsée qui génère les valeurs, ici la moyenne de x pour chaque modalité de la variable y</li>
<li>générer la syntaxe du graphique, avec comme principale difficulté la récupération des labels de <em>y</em> dans le bon “ordre”, ici décroissant avec les valeurs moyennes de <em>x</em></li>
<li>Pour présenter le graphique dans un ordre décroissant, on doit utiliser la commande externe gsort</li>
</ul>
<pre><code>ssc install gsort</code></pre>
<pre><code>* tri d&#39;une variable en ordre décroissant
gsort -x</code></pre>
<ul>
<li>On doit transformer la variable <em>y</em> la variable en format caractère (variable y2) car on ne pourra pas récupérer directement les labels avec la commande levelsof et les fonctions macro associées aux labels</li>
<li>On générère l’ordonnée commune <em>x0=0</em></li>
<li>On créer une varaible compteur <em>i</em> pour identifier l’ordre des modalités qui entre dans la création du graphique par ordre décroissant des moyennes de x, et on trie la base collapsée avec <code>gsort</code></li>
</ul>
<pre><code>collapse x, by(y)
decode y, gen(y2)
gen x0=0
sort x
gen i=_n
gsort -i

/*
     +----------------------------+
     | y          x   y2   x0   i |
     |----------------------------|
  1. | M   8.956023    M    0   9 |
  2. | W   7.969456    W    0   8 |
  3. | B   7.028172    B    0   7 |
  4. | E   6.077022    E    0   6 |
  5. | X   4.903004    X    0   5 |
     |----------------------------|
  6. | G   4.012717    G    0   4 |
  7. | A   3.022023    A    0   3 |
  8. | T   1.973236    T    0   2 |
  9. | I   .9476274    I    0   1 |
     +----------------------------+
*/     </code></pre>
<ul>
<li>Récupération dans une boucle du label des modalités dans le bonne ordre
<ul>
<li>La macro <code>r(N)</code> est associée à la commande <code>des</code> donne le nombre d’observations, ici le nombre de modalités</li>
<li>On récupère chaque modalité de la variable <code>y2</code> dans une macro qui récupère pour chaque rang (ligne) de la base, la valeur de la variable <em>y2</em>: y2[1] =“M”,…., y2[9]=“I”. Cette manipulation est en fait un <code>levelsof</code> sur les rang des observations</li>
</ul></li>
</ul>
<pre><code>qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
     
* mac list _o     
* M &quot;W&quot; &quot;B&quot; &quot;E&quot; &quot;X&quot; &quot;G&quot; &quot;A&quot; &quot;T&quot; &quot;I&quot;
* Avec levelsof on aurait: A B E G I M T W X, ce qui ne correspond pas à l&#39;ordre des labels triés avec les 9 moyennes de x
}</code></pre>
<ul>
<li>On génère la syntaxe pour <code>ylabel()</code> avec une macro empilée</li>
</ul>
<pre><code>qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  }
  
* mac list _ylab
* _ylab:  9 &quot;M&quot; 8 &quot;W&quot; 7 &quot;B&quot; 6 &quot;E&quot; 5 &quot;X&quot; 4 &quot;G&quot; 3 &quot;A&quot; 2 &quot;T&quot; 1 &quot;I&quot;
  </code></pre>
<ul>
<li>Exécution du graphique</li>
</ul>
<pre><code>local lopts lw(1)
local mopts msiz(2)

tw  pcspike i x0  i x , `lopts&#39;           /// 
||  scatter i x       , `mopts&#39;           ///
 , ylabel(`ylab&#39;, nogrid)               ///
  ytitle(&quot;&quot;) legend(off) 

restore</code></pre>
<p><strong>Programme complet</strong></p>
<pre><code>preserve 
collapse x, by(y)
decode y, gen(y2)
gen x0=0
sort x
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 
     
local lopts lw(1)
local mopts msiz(2)

tw  pcspike i x0  i x , `lopts&#39;  /// 
||  scatter i x       , `mopts&#39; ///
 , ylabel(`ylab&#39;, nogrid)  ///
   ytitle(&quot;&quot;) legend(off) 

restore</code></pre>
<p>En modifiant quelques options: choix de la couleur avec <code>colorpalette</code>, contour des bulles:</p>
<p><img src="imgp/g7b.png" style="width:50.0%" /></p>
</div>
<div id="modalités-en-highlight" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Modalités en highlight</h1>
<p>Si l’on souhaite faire apparaitre une ou plusieurs modalités dans une couleur particulière, les autres étant par exemple en gris:</p>
<ul>
<li>On sélectionne les modalités dans une macro en tête du programme</li>
<li>On génère un graphique supplémentaire pour les modalités sélectionnées, qui se superposera au graphique regroupant toutes les modalités pour lequel on sélectionne un couleur neutre (gris). La syntaxe sera générée avec une macro empilée</li>
</ul>
<p><img src="imgp/g8.png" style="width:75.0%" /></p>
<pre><code>local y 3 5 7

preserve 
collapse x, by(y)
decode y, gen(y2)
capt drop i x0
gen x0=0
sort x
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 

* modalités highlight  
colorpalette hue, select(11) nograph
local lopts lw(1) lc(&quot;`r(p1)&#39;&quot;)
local mopts msiz(2.5) mlw(vthin) mlc(black) mc(&quot;`r(p1)&#39;&quot;)
foreach y2 of local y {
local spik2 `spik2 &#39; pcspike i x0  i x if y==`y2&#39;, `lopts&#39; ||
local scat2 `scat2&#39;  scatter i x       if y==`y2&#39;, `mopts&#39; ||
  }
   
local lopts lw(1) lc(gs10)
local mopts msiz(2.5) mlw(vthin) mlc(black) mc(gs10)

tw  pcspike i x0  i x , `lopts&#39;   /// 
||  scatter i x       , `mopts&#39;   ///
|| `spik2&#39; `scat2&#39;               ///
 , ylabel(`ylab&#39;, nogrid)       ///
ylabel(,nogrid)   ytitle(&quot;&quot;) legend(off) 

restore</code></pre>
</div>
<div id="ecarts-par-rapport-à-la-moyenne" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Ecarts par rapport à la moyenne</h1>
<p><strong>En calculant la différence</strong></p>
<ul>
<li>On calcule la moyenne et on enregistre dans une macro</li>
<li>Après avoir collapser la base, on génère une variable qui donne la différence avec les moyennes des valeurs de <em>y</em></li>
<li>Avec 2 couleurs: On double les graphiques selon la valeur de la différence, en affectant une couleur si diff&lt;0 et une si diff&gt;0</li>
</ul>
<p><img src="imgp/g9.png" style="width:75.0%" /></p>
<pre><code>qui sum x
local mx = `r(mean)&#39;

preserve 
collapse x, by(y)
decode y, gen(y2)
gen diff = x - `mx&#39;
gen x0 = 0
sort diff
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 

local ymax = `r(N)&#39; + .5  
  
colorpalette hue, select(11 15) nograph
local c1 `&quot;&quot;`r(p1)&#39;&quot;&quot;&#39;
local c2 `&quot;&quot;`r(p2)&#39;&quot;&quot;&#39;  
  
local lopts lw(1) 
local mopts msiz(2.5) mlw(vthin) mlc(black)

tw  pcspike i x0  i diff if diff&gt;0 , `lopts&#39; lc(&quot;`r(p1)&#39;&quot;)  /// 
||  scatter i diff       if diff&gt;0 , `mopts&#39; mc(&quot;`r(p1)&#39;&quot;)  ///
||  pcspike i x0  i diff if diff&lt;0 , `lopts&#39; lc(&quot;`r(p2)&#39;&quot;)  /// 
||  scatter i diff       if diff&lt;0 , `mopts&#39; mc(&quot;`r(p2)&#39;&quot;)  ///
 , ylabel(0.5 &quot; &quot; `ylab&#39; `ymax&#39; &quot; &quot;, nogrid) ///
  ytitle(&quot;&quot;) legend(off) 

restore</code></pre>
<p>Dans le programme, j’ai éloigné la première et la dernière valeur de <em>y</em> du minimum (0) et du maximum de l’axe (9) de 0.5:</p>
<pre><code>local ymax = `r(N)&#39; + .5
*(...)
ylabel(.5 &quot; &quot;  `ylab&#39; `ymax&#39; &quot; &quot;, nogrid)</code></pre>
<p><strong>En mettant la moyenne en valeur pivot</strong></p>
<ul>
<li>On ajoute un objet graphique type <code>pci</code> pour créer la barre verticale</li>
<li>La valeur de la moyenne est reportée sur l’axe <em>x</em> après avec réduit le nombre de décimales de la macro <code>mx</code> en début de programme</li>
</ul>
<p><img src="imgp/g10.png" style="width:75.0%" /></p>
<pre><code>qui sum x
local mx: di %10.3f `r(mean)&#39;
di `mx&#39;

preserve 
collapse x, by(y)
decode y, gen(y2)
gen mx = `mx&#39;
gen x0 = 0
sort x
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 

local ymax = `r(N)&#39; + .5  
  
colorpalette hue, select(11) nograph

local lopts lw(1) lc(&quot;`r(p1)&#39;&quot;)
local mopts msiz(2.5) mlw(vthin) mlc(black) mc(&quot;`r(p1)&#39;&quot;)

tw pci 0 `mx&#39; `ymax&#39; `mx&#39;, lw(1) lc(&quot;`r(p1)&#39;&quot;)      ///
||  pcspike i mx i x , `lopts&#39;                /// 
||  scatter i x       , `mopts&#39;   ///
||   , ylabel(.5 &quot; &quot; `ylab&#39; `ymax&#39; &quot; &quot;, nogrid) ///
       xlabel(0(1)4 `mx&#39; 6(1)10) ///
       ytitle(&quot;&quot;) legend(off) 
restore</code></pre>
<p>Tous les graphiques précédents peuvent être affichés sous forme de barres, en modifiant l’épaisseur des <code>spike</code>. Par exemple avec une épaisseur de <em>5</em> et en supprimant les bulles:</p>
<p><img src="imgp/g11.png" style="width:75.0%" /></p>
<pre><code>local y 3 5 7

preserve 
collapse x, by(y)
decode y, gen(y2)
capt drop i x0
gen x0=0
sort x
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 

** modalités highlight  
colorpalette hue, select(11) nograph
local lopts lw(5) lc(&quot;`r(p1)&#39;&quot;)
foreach y2 of local y {
local spik2 `spik2 &#39; pcspike i x0  i x if y==`y2&#39;, `lopts&#39; ||
  }
   
local lopts lw(5) lc(gs10)

tw  pcspike i x0  i x , `lopts&#39;   /// 
|| `spik2&#39;                         ///
 , ylabel(`ylab&#39;, nogrid)       ///
 ytitle(&quot;&quot;) xtitle(&quot;&quot;) legend(off) 

restore</code></pre>
</div>
<div id="variable-supplémentaire" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Variable supplémentaire</h1>
<p>Nouvelle variable z</p>
<pre><code>gen z= runiform(0, .6)
replace z= runiform(.3, 8) if inlist(y,2,5,6,8) 
replace z=z&lt;.5
separate x, by(z)</code></pre>
<p><strong>Graphique standard de type barre</strong></p>
<ul>
<li>Les moyennes de x sont triées selon leurs valeurs pour z=0</li>
<li>Rendu du graphique plutôt chargé</li>
</ul>
<p><img src="imgp/g12.png" style="width:75.0%" /></p>
<pre><code>grstyle init,
grstyle set color hue, select(11 15)
grstyle set mesh, compact horizontal
grstyle set legend, nobox

separate x, by(z)

graph hbar x0 x1, over(y, sort(1) descending) legend(order(1 &quot;z=0&quot; 2 &quot;z=1&quot;))</code></pre>
<p><strong>Graphique de type /haltère</strong></p>
<ul>
<li>Les segments (<code>pcspike</code>) vont de x0 à x1 et non plus de 0 à x</li>
<li>On ajoute un nuage de point, un pour x0 (z=0) et un pour x1 (z=1)</li>
</ul>
<p><img src="imgp/g13.png" style="width:75.0%" /></p>
<pre><code>preserve 

collapse x0 x1, by(y)

decode y, gen(y2)
sort x0
gen i=_n
gsort -i

qui des
forvalues j = 1/`r(N)&#39; {
     local o `o&#39; &quot;`=y2[`j&#39;]&#39;&quot;
}    
        
qui des
local j = `r(N)&#39;
foreach o2 of local o {
local ylab `ylab&#39; `j--&#39; &quot;`o2&#39;&quot;
  } 
  
local ymax = `r(N)&#39; + .5    
local lopts lw(1) lc(gs8)
local mopts msiz(2) mlc(black) mlw(vthin)
colorpalette hue, select(11 15) nograph

tw  pcspike i x0  i x1 , `lopts&#39;  /// 
||  scatter i x0       , `mopts&#39; mc(&quot;`r(p1)&#39;&quot;)  ///
||  scatter i x1       , `mopts&#39; mc(&quot;`r(p2)&#39;&quot;)  ///
 , ylabel(.5 &quot; &quot; `ylab&#39; `ymax&#39; &quot; &quot;, nogrid) ///
   ytitle(&quot;&quot;)  legend(order(2 &quot;z=0&quot; 3 &quot;z=1&quot;))

restore</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
